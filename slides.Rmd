---
title: "How to write an R package and publish it on GitHub"
author: "Aya Mitani"
date: "2021/01/07"
output: 
  beamer_presentation:
    slide_level: 3
    keep_tex: true
    includes:
      in_header: preamble.txt
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE,
                      class.source = "bg-warning",
                      class.output = "bg-success")
library(available)
library(here)
library(devtools)
```

### What is an R package?
- Collection of code, data, documentation developed by the R community
- Addresses particular problem with specialized statistical technique, graphical device, etc. 
- A core set of packages comes with base R
- $>$ 15,000 Additional packages are available from CRAN, Bioconductor, Omegahat, GitHub, etc.
- Popular R packages 
  + `dplyr`
  + `ggplot2`

\begin{figure}
  \includegraphics[scale=0.2]{slides_files/figure-beamer/dplyrggplot2.png}
\end{figure}

### What is GitHub?
- Website that hosts software development and version control using Git
- Free basic services

\begin{figure}
  \includegraphics[scale=0.2]{slides_files/figure-beamer/GitHub.png}
\end{figure}

### Why write R package?
* For yourself
* For others
  + Increasingly, (bio)statistical journals ask for R package development of novel method

### Why publish package on GitHub?
- Reproducibility
- Accessibility
- Collaboration
- Back-up method

### What do you need to write R package?
- R Studio (https://rstudio.com/)
- `devtools` package
- Git (https://git-scm.com/)
- GitHub account (https://github.com/)

\textcolor{blue}{Some other useful packages}

- `here` 
- `available`

\begin{figure}
  \includegraphics[scale=0.2]{slides_files/figure-beamer/Rstudio.png}
\end{figure}

### Let's begin!
**Major steps**

1. Create new repo in GitHub
    i) Copy URL
2. Open R Studio
    i) New Project $\rightarrow$ Version Control $\rightarrow$ Git $\rightarrow$ Enter info $\rightarrow$ Create Project
    ii) Install `devtools` 
    iii) Build package
3. Pull + Commit + Push
4. Use/share package with `install_github()`!

### In GitHub
First, log in and go to Repositories
\begin{figure}
  \includegraphics[scale=0.275]{slides_files/figure-beamer/GitHub_step1.png}
\end{figure}

### In GitHub
Then, create new repository
\begin{figure}
  \includegraphics[scale=0.275]{slides_files/figure-beamer/GitHub_step2.png}
\end{figure}

### In GitHub
Repo name should be same as package name
\begin{figure}
  \includegraphics[scale=0.275]{slides_files/figure-beamer/GitHub_step3.png}
\end{figure}

### Aside: Naming R package
Some tips:

* Make it short
* If one word, use all lowercase
* If multiple words, mix lowercase and uppercase
* Avoid using characters (`.`, `_`) between words

### Aside: Naming R package
Check to see if name is unique, especially if you plan to submit to CRAN
\footnotesize
```{r, eval = FALSE}
install.packages("available")
library(available)
```
```{r}
available("ayapack", browse = FALSE)
```

### Back to GitHub
Finish creating new repo
\begin{figure}
  \includegraphics[scale=0.275]{slides_files/figure-beamer/GitHub_step4.png}
\end{figure}

### In GitHub
Finally, copy URL
\begin{figure}
  \includegraphics[scale=0.275]{slides_files/figure-beamer/GitHub_step5.png}
\end{figure}

### In RStudio
Load libraries
```{r, eval = FALSE}
library(devtools)
library(here)
```

### Turn this project into a package
```{r, eval = FALSE}
devtools::create(here::here())
```
This will create 3 additional files

* DESCRIPTION: This is where all the meta-data about your package goes. You can edit this file manually. 
* NAMESPACE: This file indicates what needs to be exposed to users for your R package. Do not edit this file. 
* R: This is where all your R code goes for your package.


### Add your function
Open new R script and write your function

```{r, eval = FALSE}
myfunc <- function(x){
  y <- x + x
  return(y)
}
```

### Add your function
Include `@export` tag above your function to indicate this function to be “exposed” to users.

```{r, eval = FALSE}
#' @export
myfunc <- function(x){
  y <- x + x
  return(y)
}
```

### Add your function
Also, include documentation for your function when you go `?myfunc`. \small
```{r, eval = FALSE}
#' This is my function.
#'
#' This function returns a value from adding the parameters.
#' @param x
#' @return y
#' @export
myfunc <- function(x){
  y <- x + x
  return(y)
}
```

### Add your function
Now run

```{r, eval = FALSE}
devtools::document()
```

* This will create `man` directory that includes read-only file `myfunc.Rd`
* Note that `NAMESPACE` file has been updated

### Add data set


